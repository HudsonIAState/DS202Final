---
title: "Final Project: Nutrition, Physical Activity, and Obesity Analysis"
author: "Your Name(s)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
# Load required libraries
library(dplyr)
library(ggplot2)
library(readr)
```

## Data Description

The dataset used for this analysis is from the Behavioral Risk Factor Surveillance System and can be found at https://catalog.data.gov/dataset/nutrition-physical-activity-and-obesity-behavioral-risk-factor-surveillance-system/resource/0280bb9c-4de8-4b95-9642-93f727c4d305. The data provides health-related info on nutrition, physical activity, and obesity among adults in the United States. The data seems to be gathered annually (from 2011 - 2023) and contains variables related to location, health topics, data values, confidence intervals, and demographics

Key Variables:

`YearStart` and `YearEnd`: Indicate the time period of data collection.
`LocationAbbr` and `LocationDesc`: Provide geographic information.
`Class`, `Topic`, `Question`: Classify the health measures and behaviors.
`Data_Value`: Represents the main health measurement.
`Age`, `Education`, `Gender`, `Income`, `Race/Ethnicity`: Demographic categories for stratified analysis.

Another thing of note, many columns contain null values due to the varying nature of the `Question` variable. If we were to just remove all rows that have null column values, This would be a misstep.

## Primary Data Cleaning

```{r}
data_url <- "https://chronicdata.cdc.gov/api/views/hn4x-zwk7/rows.csv?accessType=DOWNLOAD"
data <- read_csv(data_url)

cleaned_data <- data %>%
  filter(!is.na(Data_Value))

View(cleaned_data)

cleaned_data <- cleaned_data %>%
  select(YearStart, LocationDesc, Class, Topic, Question, Data_Value, `Age(years)`, Education, Gender, Income, 'Race/Ethnicity')

summary(cleaned_data)

```
## Marginal Summaries
``` {r}
summary(cleaned_data$Data_Value)

class_counts <- cleaned_data %>%
  count(Class) %>%
  arrange(desc(n))

print(class_counts)
```

We can see that the average data_value lands right around 32-ish percent of any given group, so we will be able to use this as a gauge of "good" if a data value is greater than 32, and "bad" if the data value is less than 32.

``` {r}
ggplot(cleaned_data, aes(x = Data_Value)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of Data Values by Class", x = "Data Value", y = "Frequency") +
  facet_wrap(~ Class, scales = "free_y") +
  theme_minimal()

```


I thought it might be interesting to see the distribution of each class of data value, and the frequency that it occurred. This would give us some sort of idea what our data focused on, and how much a single statistic may vary.

## Questions to be Addressed

1. **How do nutrition, physical activity, and obesity metrics vary across different states?**
   - We will analyze how these health measures differ by location and explore geographic patterns.
   
``` {r}
# Filter data for the specific question
obesity_data <- cleaned_data %>%
  filter(Question == "Percent of adults aged 18 years and older who have obesity") %>%
  select(LocationDesc, Data_Value)

# View the resulting dataframe
head(obesity_data)

# If you want the dataframe grouped by state:
state_obesity <- obesity_data %>%
  group_by(LocationDesc) %>%
  summarise(Average_Obesity_Percent = mean(Data_Value, na.rm = TRUE))

# View summarized data
head(state_obesity)   

highest_obesity <- state_obesity %>%
  arrange(desc(Average_Obesity_Percent))

# View the highest percentages
head(highest_obesity)

# Create a dataframe for the lowest percentages
lowest_obesity <- state_obesity %>%
  arrange(Average_Obesity_Percent)

# View the lowest percentages
head(lowest_obesity)

# Ensure the states are ordered alphabetically
state_obesity <- state_obesity %>%
  arrange(LocationDesc)

# Split the data into two halves: lowest and highest
halfway_point <- nrow(state_obesity) / 2

# Lowest obesity data (first half)
lowest_half <- state_obesity %>%
  arrange(Average_Obesity_Percent) %>%
  head(halfway_point)

# Highest obesity data (second half)
highest_half <- state_obesity %>%
  arrange(desc(Average_Obesity_Percent)) %>%
  head(halfway_point)

# Plot for lowest obesity data
ggplot(lowest_half, aes(x = reorder(LocationDesc, Average_Obesity_Percent), y = Average_Obesity_Percent)) +
  geom_bar(stat = "identity", fill = "lightblue", color = "black", alpha = 0.7) +
  labs(
    title = "Lowest Obesity Percentage by State",
    x = "State",
    y = "Average Obesity Percentage"
  ) +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.y = element_text(size = 8, hjust = 1))

# Plot for highest obesity data
ggplot(highest_half, aes(x = reorder(LocationDesc, Average_Obesity_Percent), y = Average_Obesity_Percent)) +
  geom_bar(stat = "identity", fill = "salmon", color = "black", alpha = 0.7) +
  labs(
    title = "Highest Obesity Percentage by State",
    x = "State",
    y = "Average Obesity Percentage"
  ) +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.y = element_text(size = 8, hjust = 1))
```

2. **What demographic factors (age, gender, income, education, race/ethnicity) are most associated with variations in health metrics?**
   - We will investigate if there are significant differences in data values based on demographic stratifications.
   
``` {r}
library(gridExtra)
library(grid)



unique_qs <- unique(cleaned_data$Question)
head(unique_qs, 9)

# Split all the questions into their own df section (we'll use these later)
question_list <- split(cleaned_data, cleaned_data$Question)

head(question_list[[unique_qs[1]]])

q_titles <- c("% has obesity", "% 75m high card + muscle training", "% are overweight", 
             "% just muscle training", "% no physical activity", "% 75m high card training",
             "% 150m high card training", "% consuming fruit < 1 daily", "% consuming veg < 1 daily")

# Assuming unique_qs is the vector of unique question names (e.g., obtained with unique(cleaned_data$Question))

for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Male"
  filtered_data <- question_data %>%
    filter(Gender == "Male")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = Gender, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "lightblue", color = "lightblue", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}
rt <- textGrob("Health questions grouped by: Males", gp = gpar(fontsize = 16, fontface = "bold", rotate= 90))

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Males", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```
   
``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(Gender == "Female")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = Gender, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "salmon", color = "salmon", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Females", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```

``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Race/Ethnicity` == "Hispanic")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Race/Ethnicity`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "forestgreen", color = "forestgreen", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Hispanic", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```

``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Race/Ethnicity` == "Non-Hispanic White")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Race/Ethnicity`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "grey", color = "grey", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Non-Hispanic White", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```

``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Race/Ethnicity` == "Asian")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Race/Ethnicity`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "purple", color = "purple", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Asian", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```

``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Race/Ethnicity` == "Non-Hispanic Black")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Race/Ethnicity`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "orange", color = "orange", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Non-Hispanic Black", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```
``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Race/Ethnicity` == "American Indian/Alaska Native")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Race/Ethnicity`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "aquamarine", color = "aquamarine", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: American Indian/Alaska Native", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```
``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Age(years)` == "18 - 24")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Age(years)`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "yellow", color = "yellow", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Age 18 - 24", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```
``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Age(years)` == "25 - 34")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Age(years)`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "orange", color = "orange", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Age 25 - 34", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```

``` {r}
for (i in 1:length(unique_qs)) {
  
  # Extract the data for the current question
  question_data <- question_list[[unique_qs[i]]]
  
  # Filter data based on condition, e.g., Gender == "Female"
  filtered_data <- question_data %>%
    filter(`Age(years)` == "35 - 44")  # You can change the condition here
  
  # Compute the average value of Data_Value
  avg_data_value <- filtered_data %>%
    summarise(Average_Value = mean(Data_Value, na.rm = TRUE)) %>%
    pull(Average_Value)
  
   plot_name <- paste0("plot", i)
  # Create a plot for the current question with the average value
  assign(plot_name , ggplot(title = "ten", filtered_data, aes(x = `Age(years)`, y = Data_Value)) +
    geom_bar(stat = "identity", fill = "red", color = "red", alpha = 0.7) +
    labs(
      title = paste(q_titles[i]),
      subtitle = paste("Average Value:", round(avg_data_value, 2)),
      x = "",
      y = ""
    ) +
    theme_minimal() +
    theme(axis.text.y = element_text(size = 8, hjust = 1), plot.title = element_text(size = 10))
  )
}

# Combine all plots into a grid (3 rows and 3 columns in this case)
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, nrow = 3, ncol = 3, top = textGrob("Health questions grouped by: Age 35 - 44", gp = gpar(fontsize = 16, fontface = "bold"))) 

grid.text("Count of demographic", 
          x = unit(.014, "npc"), y = unit(0.5, "npc"), 
          rot = 90, gp = gpar(fontsize = 16, fontface = "bold"))

grid.text("Demographic", 
          x = unit(.5, "npc"), y = unit(.03, "npc"), 
          rot = 0, gp = gpar(fontsize = 16, fontface = "bold"))

```


```{r}
# Assuming 'cleaned_data' is your data frame and 'cols_data' contains the column names
cols_data <- c('Age(years)', "Education", "Gender", "Income", "Race/Ethnicity")

# Get unique values for each column
data1 <- unique(cleaned_data[[cols_data[1]]])
data1 <- data1 <- na.omit(data1)
data2 <- unique(cleaned_data[[cols_data[2]]])
data2 <- data2 <- na.omit(data2)
data3 <- unique(cleaned_data[[cols_data[3]]])
data3 <- data3 <- na.omit(data3)
data4 <- unique(cleaned_data[[cols_data[4]]])
data4 <- data4 <- na.omit(data4)
data5 <- unique(cleaned_data[[cols_data[5]]])
data5 <- data5 <- na.omit(data5)

# Combine all unique values from all columns into a new list
new_cols_data <- list(na.omit(data1), na.omit(data2), na.omit(data3), na.omit(data4), na.omit(data5))

avg_list <- list()
meaning_list <- list()
questions_avg <- list()
  for (j in 1:length(unique_qs)) {
    for(i in 1:length(cols_data)) {
      for(k in 1:length(new_cols_data[[i]])) {
        
      
      # Extract the data for the current question
      question_data <- question_list[[unique_qs[j]]]
      
      # Filter data based on condition, e.g., Gender == "Male"
      filtered_data <- question_data %>%
      filter(.[[cols_data[i]]] == new_cols_data[[i]][k])
      head(filtered_data)
      
      avg <- paste0("avg",i,j,k)
      avg_list[[avg]] <- mean(filtered_data$Data_Value)
      meaning_list[[avg]] <- new_cols_data[[i]][k]
      questions_avg[[avg]] <- unique_qs[j]
      }
  }
}

df <- data.frame(
  doubles = unlist(avg_list),
  chars = unlist(meaning_list),
  chars2 = unlist(questions_avg),
  stringsAsFactors = FALSE
)

obesity_rates <- df %>% 
  filter(chars2 == unique_qs[1])

filtered_df <- obesity_rates %>%
  arrange(desc(doubles))

head(filtered_df, 10)

```

3. **Has there been a significant change over time in key health metrics from YearStart to YearEnd?**
   - We will examine trends over the years to see if public health interventions have had an impact.
   
``` {r}


```

4. **What is the relationship between socioeconomic status (e.g., income, education) and health measures like obesity and physical activity?**
   - We will perform correlation and regression analyses to understand these relationships.
   
``` {r}

```